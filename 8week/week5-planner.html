<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" href="assets/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Planner</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />

	<!--     Fonts and icons     -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />

	<!-- CSS Files -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/material-kit.css" rel="stylesheet"/>

    <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">

    <style>
    	.img-logo {
    		max-height: 80px;
    	}
    	.handwritting {
    		font-family: 'Permanent Marker', cursive;
    	}
    	h4 {
    		font-weight: 700;
    		font-size: 1.2em;
    	}
    	.indented p {
    		margin-left: 40px;
    	}
    	.indented {
    		margin-left: 40px;
    	}
    	.white-card {
    		padding: 20px;
    		color:black!important;
    	}
    	.fold-up {
    		margin-top: 0px!important;
    	}
    	.template {
    		display: none;
    	}
    	form {
    		z-index: 9;
    	}
    	.dropdown-menu {
    		z-index: 99;
    	}
    	.removable {
    		
    	}
    	.table-container {
    		padding: 20px;
    	}
    	.gap {
    		margin-bottom: 30px;
    	}
    	.selected {
    		border: 5px solid #9c27b0!important;
    	}
    	.box {
    		border: 1px solid #9c27b0!important;
    	}
    	.shopping-list {
    		padding: 40px;
    	}
    	.planFood {
    		background-color: #e91e63!important;
    		color:white;
    	}
    	.planExercise {
    		background-color: #00bcd4!important;
    		color:white;
    	}
    	.planFood.planExercise {
    		background: linear-gradient(60deg, #e91e63, #00bcd4)!important;
    	}
    	.panal-header h4 {
    		color:white!important;
    	}
    	.panel-heading .planFood {
    		background: rgba(0, 188, 212, 0.5)!important;
    	}
    	.hide {
    		display: none;
    	}
    	.height-control {
    		min-height: 1200px;
    	}
    	td {
    		cursor: pointer;
    		font-size: 10px;
    	}
    	td input {
    		margin: 0!important;
    		padding: 0!important;
    	}
    	.form-group {
    		margin: 0!important;
    		padding: 0!important;
    	}
    	textarea.form-control{
    		font-weight: 700!important;
    		font-size: 18px;
    	}
    	.table-even {
    		width: 10%;
    	}
    	.ingredient-template {
    		display: none;
    	}
    	.bold-title {
    		font-weight: 600;
    		margin-top: 50px;
    	}

    </style>

</head>

<body class="signup-page">
	<nav class="navbar navbar-transparent navbar-absolute">
    	<div class="container">
        	<img src="assets/img/white-logo.png" alt="First foot forward" class=" img-logo">
        	<img src="assets/img/8-week-challenge-w.png" alt="First foot forward" class=" img-logo pull-right">
        	
    	</div>
    </nav>

    <div class="wrapper">
		<div class="header header-filter" style="background-image: url('aaron-burden-123584.jpg'); background-size: cover; background-position: top center;">
			<div class="container">
					
						

						<div  id="before" class="card card-signup height-control">
						<h2 class="text-center">Week Six Planner</h2>
						<p class="text-center">Use this table to plan next week's meals and exercise (Mon 7th - Sun  13th)</p>
						<p class="text-center"><a href="#" onClick="readTracker(5)">Click here</a> to go to this weeks meal, exercise and mood <b>Tracker</b></p>
						<p class="text-center"><a href="week4-blog.html">Click here</a> to read more about the benefits of meal planning</p>
							<div class="table-container">
								<table class="table table-bordered">
								    <thead>
								        <tr>
								            <th class="col-xs-1">#</th>
								            <th class="table-even" >M</th>
								            <th class="table-even">T</th>
								            <th class="table-even">W</th>
								            <th class="table-even">T</th>
								            <th class="table-even">F</th>
								            <th class="table-even">S</th>
								            <th class="table-even">S</th>
								        </tr>
								    </thead>
								    <tbody >
								        <tr class="table-button">
								            <td class="text-center">Breakfast</td>
								            <td id="b0" ></td>
								            <td id="b1" ></td>
								            <td id="b2" ></td>
								            <td id="b3" ></td>
								            <td id="b4" ></td>
								            <td id="b5" ></td>
								            <td id="b6" ></td>
								        </tr>
								        <tr class="table-button">
								            <td class="text-center">Morning</td>
								            <td id="m0" ></td>
								            <td id="m1" ></td>
								            <td id="m2" ></td>
								            <td id="m3" ></td>
								            <td id="m4" ></td>
								            <td id="m5" ></td>
								            <td id="m6" ></td>
								        </tr>
								        <tr class="table-button">
								            <td class="text-center">Lunch</td>
								            <td id="l0" ></td>
								            <td id="l1" ></td>
								            <td id="l2" ></td>
								            <td id="l3" ></td>
								            <td id="l4" ></td>
								            <td id="l5" ></td>
								            <td id="l6" ></td>
								        </tr>
								        <tr class="table-button">
								            <td class="text-center">Afternoon</td>
								            <td id="a0" ></td>
								            <td id="a1" ></td>
								            <td id="a2" ></td>
								            <td id="a3" ></td>
								            <td id="a4" ></td>
								            <td id="a5" ></td>
								            <td id="a6" ></td>
								        </tr>
								        <tr class="table-button">
								            <td class="text-center">Dinner</td>
								            <td id="d0" ></td>
								            <td id="d1" ></td>
								            <td id="d2" ></td>
								            <td id="d3" ></td>
								            <td id="d4" ></td>
								            <td id="d5" ></td>
								            <td id="d6" ></td>
								        </tr>
								        <tr class="table-button">
								            <td class="text-center">Evening</td>
								            <td id="e0" ></td>
								            <td id="e1" ></td>
								            <td id="e2" ></td>
								            <td id="e3" ></td>
								            <td id="e4" ></td>
								            <td id="e5" ></td>
								            <td id="e6" ></td>
								            
								        </tr>
								    </tbody>
								</table>
								<br />
								<div class="col-md-12">
											<b><h3 id="time-date-title" class="text-center bold-title"></h3></b>
										</div>
								<div id="plan-choice" class="container hide">
										
									<row class="center-block">
										
										<div class="col-xs-6">
											<button onClick="foodPlan()" class="col-xs-10 btn planFood">Food</button>
										</div>
										<div class="col-xs-6">
											<button onClick="exercisePlan()" class="col-xs-10 btn btn-info">Exercise</button>
										</div>
									</row>
								</div>

								<div id="planFoodPanal" class="panel panel-default hideable hide">
								  <!-- Default panel contents -->
								  <div class="panel-heading planFood text-center"><h4>Food Tracker<h4></div>
								  <div class="panel-body">
								  	<b>Meal</b>
								    <textarea id="food-plan-content" class="gap form-control" placeholder="Record your entry here ..." rows="5"></textarea>
								    <!-- Table -->
									  <div >
									  	<row>
										    <div class="col-xs-6"><b>Ingredient</b></div>
											<div class="col-xs-6"><b>Amount</b></div>	
										</row>
									    <div id="insertingredient" class="row">
									        
									    </div>


									  </div>
								  </div>

								  
								  <button onClick="foodPlanSave()" class="col-xs-12 btn btn-primary">Save</button>
								</div>
								<div id="planExercisePanal" class="panel panel-default hideable hide">
									  <!-- Default panel contents -->
									  <div class="panel-heading text-center planExercise"><h4>Exercise Tracker<h4></div>
									  <div class="panel-body">
									    <textarea id="exercise-plan-content" class="gap form-control" placeholder="Record your entry here ..." rows="5"></textarea>
									  </div>

									  
									  <button onClick="exercisePlanSave()" class="col-xs-12 btn btn-primary">Save</button>
									</div>
							</div>
							<br />
							<br />
							<br />
							<h3 class="text-center bold-title">Shopping List</h3>
							<div id="insertshopping" class="row shopping-list">
								
							</div>
						</div>
			</div>
		</div>
    </div>

	<div  id="ingredienttemplate" class="hide">
			<div class="col-xs-5"><input type="text" value="" placeholder="New Entry ....." class="form-control icontent" /></div>
			<div class="col-xs-4"><input type="text" value="" placeholder="" class="form-control iamount" /></div>
			<button onClick="ingredientUpdate()" class="col-xs-2 btn btn-xs">Update</button>		
	</div>
	<div  id="shoppingtemplate" class="hide col-sm-6 box">
			<div class="col-xs-7 "><b class="icontent"></b></div>
			<div class="col-xs-5 iamount text-right"></div>	
	</div>


</body>
	<!--   Core JS Files   -->
	<script src="assets/js/jquery.min.js" type="text/javascript"></script>
	<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="assets/js/material.min.js"></script>

	<!-- Control Center for Material Kit: activating the ripples, parallax effects, scripts from the example pages etc -->
	<script src="assets/js/material-kit.js" type="text/javascript"></script>

	<script>

	var code = null;

	var entrytype = "food";
	var day = "17";
	var time = "9";

	

	

	var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    };

    	function selectedItem(value, text, id) {
    		$( "#"+id ).html( text + ' <b class="caret"></b>' );
    		if(id === "type"){
    			entrytype = value;
    		}
    		if(id === "day"){
    			day = value;
    		}
    		if(id === "time"){
    			time = value;
    		}
    	}

		function sendPost() {

    		var when = "2017-07-" + day + " " + time + ":00:00 UTC";
    		var content = $("#content").val();

			if( getUrlParameter('u') === undefined ) {
        		window.location.href = "master-index.html";
		    } else {
		            $.post( "https://rocky-earth-6889.herokuapp.com/trackeds.json", {"tracked": {"user": getUrlParameter('u'), "entrytype": entrytype, "when": when, "content":content}} )
		              .done(function( data ) {
		              	$("#content").val(" ");
		               	fetch();
		            });
		        

		    }
		}

		function dateWrangler(date) {
			var day = date.substring(0,10);
			var time = date.substring(11,16);

			if(date.substring(8,10) == "24") { day = "Monday";}
			if(date.substring(8,10) == "25") { day = "Tuesday";}
			if(date.substring(8,10) == "26") { day = "Wednesday";}
			if(date.substring(8,10) == "27") { day = "Thursday";}
			if(date.substring(8,10) == "28") { day = "Friday";}
			if(date.substring(8,10) == "29") { day = "Saturday";}
			if(date.substring(8,10) == "30") { day = "Sunday";}

			if(date.substring(11,13) == "09") { time = "Breakfast";}
			if(date.substring(11,13) == "12") { time = "Lunch";}
			if(date.substring(11,13) == "18") { time = "Dinner";}
			if(date.substring(11,13) == "10") { time = "Morning Snack";}
			if(date.substring(11,13) == "15") { time = "Afternoon Snack";}
			if(date.substring(11,13) == "20") { time = "Evening Snack";}

			return day + " - " + time;
		}
    		

    	function fetch() {

    		

    		$.get( "https://notes.1stfootforward.co.nz/tracked/fetch.json", { user: getUrlParameter('u') } )
			  .done(function( data ) {

			    
				    $.each(data, function(i, item) {

				    	if( (new Date(data[i].when)) > (new Date("Sun Jul 23 2017 23:59:00")) ) {


					    
						    var template = $( ".template" ).clone()

				    		template.removeClass('template');
				    		template.addClass('removable');
				    		template.find( "h4" ).html( dateWrangler( data[i].when) );
				    		template.find( "p" ).html( " <b>" + data[i].entrytype + ":</b>  " + data[i].content );

				    		$("#insert").append(template);
				    	}
					})
			});
    		
    		
    	}

    	


    	var times = [ 'b', 'm', 'l', 'a', 'd', 'e'];
		var planFood;
		var planExercise;

		var food;
		var exercise;

		var ingredients = [{ code: 'xy', ingredient: '' }];

		var week = "week5"

		function englishWrangler(code) {

			var time = "";
			var day = "";

			switch( code.substring(0,1) ) {
			    case 'b':
			        time = "Breakfast";
			        break;
			    case 'm':
			        time = "Morning";
			        break;
			    case 'l':
			        time = "Lunch";
			        break;
			    case 'a':
			        time = "Afternoon";
			        break;
			    case 'd':
			        time = "Dinner";
			        break;
			    case 'e':
			        time = "Evening";
			        break;
			    default:
			        time = " - ";
			}

			switch( code.substring(1,2) ) {
			    case '0':
			        day = "Monday";
			        break;
			    case '1':
			        day = "Tuesday";
			        break;
			    case '2':
			        day = "Wednesday";
			        break;
			    case '3':
			        day = "Thursday";
			        break;
			    case '4':
			        day = "Friday";
			        break;
			    case '5':
			        day = "Saturday";
			        break;
			    case '6':
			        day = "Sunday";
			        break;
			    default:
			        day = " - ";
			}

			return day + " - " + time;

		}

    	function setupPlan() {
    		for (var i = times.length - 1; i >= 0; i--) {
    			
    			
    			for (var x = planFood[ times[i] ].length - 1; x >= 0; x--) {
    				if( planFood[ times[i] ][x] != " " ){
    					
    					$("#" + times[i] + x).addClass("planFood")
    				}
    			}
    		}
    		for (var i = times.length - 1; i >= 0; i--) {
    			
    			
    			for (var x = planExercise[ times[i] ].length - 1; x >= 0; x--) {
    				if( planExercise[ times[i] ][x] != " " ){
    					
    					$("#" + times[i] + x).addClass("planExercise")
    				}
    			}
    		}
    		
    	}



    	$( ".table-button td" ).click(function() {

    		$(".removable").remove();

    		$(".hideable").addClass("hide");

    		$('.selected').removeClass("selected");

    		$('#plan-choice').removeClass("hide");

		  	$(this).addClass( "selected" );

		  	setupEntry($(this).attr('id'));

		    shoppingList();
		});

		function checker(entry) {

			if( entry.user ===  getUrlParameter('u') && entry.weekname ===  getUrlParameter('w') && entry.plan === 0 ) {
				return true;
			} else {
				return false;
			}


		}

    	function grab() {

    			$.get( "https://notes.1stfootforward.co.nz/calendar_entry/fetch.json", {user: getUrlParameter('u')} )
					  .done(function( data ) {

					    
						    $.each(data, function(i, item) {

						    	if( checker(data[i]) ) {

						    		if( data[i].colour === "food" ) {

						    			if( data[i].codea === 'B') { 

						    				data[i].codea ='b'; 
						    			}


						    			planFood[ data[i].codea ][ data[i].codeb ] = data[i].content;
						    		}

						    		if( data[i].colour === "exercise" ) {

						    			planExercise[ data[i].codea ][ data[i].codeb ] = data[i].content;
						    		}
						    	}


							})
							setupPlan();
					});

				$.get( "https://notes.1stfootforward.co.nz/ingredient_entries.json" )
					  .done(function( data ) {

					   
						    $.each(data, function(i, item) {

						    	if( checker(data[i]) ) {

						    		

						    			if( data[i].codea === 'B') { 

						    				data[i].codea ='b'; 
						    			}


						    			ingredients[ingredients.length] = { code: data[i].code, ingredient: data[i].content, amount: data[i].amount }
						    		
						    			
						    		
						    		
						    	}


							})
							shoppingList();
							
					});



    	}

		setup();
		

		function setup() {
			var b = [" "," "," "," "," "," "," "];
			var m = [" "," "," "," "," "," "," "];
			var l = [" "," "," "," "," "," "," "];
			var a = [" "," "," "," "," "," "," "];
			var d = [" "," "," "," "," "," "," "];
			var e = [" "," "," "," "," "," "," "];
			var ba = [" "," "," "," "," "," "," "];
			var ma = [" "," "," "," "," "," "," "];
			var la = [" "," "," "," "," "," "," "];
			var aa = [" "," "," "," "," "," "," "];
			var da = [" "," "," "," "," "," "," "];
			var ea = [" "," "," "," "," "," "," "];
			planFood = {'b': b,'m': m,'l': l,'a': a,'d': d,'e': e};
			planExercise = {'b': ba,'m': ma,'l': la,'a': aa,'d': da,'e': ea};

			grab();


		}

		

		function setupEntry(id) {

			$("#time-date-title").html( englishWrangler(id) );

			code = id;

			if(planExercise[ id.substring(0,1) ][id.substring(1,2)].length > 1) {
				exercisePlan();
			}
			if(planFood[ id.substring(0,1) ][id.substring(1,2)].length > 1) {
				foodPlan();
			}

		}

		

		function exercisePlan() {
			$("#exercise-plan-content").val(" ");

			$(".hideable").addClass("hide");

			$("#exercise-plan-content").val("" + planExercise[ code.substring(0,1) ][code.substring(1,2)]) ;

			$("#planExercisePanal").removeClass("hide");

		}

		function exercisePlanSave() {


			$.post( "https://rocky-earth-6889.herokuapp.com/calendar_entries.json", {"calendar_entry":{"user": getUrlParameter('u') ,"code":code, "codea": code.substring(0,1), "codeb":parseInt(code.substring(1,2)), "week":"2017-07-31", "weekname": getUrlParameter('w'), "plan":0, "content": $("#exercise-plan-content").val(), "colour":"exercise" }} )
		              .done(function( data ) {
		              	
		              	planExercise[ code.substring(0,1) ][code.substring(1,2)] = $("#exercise-plan-content").val();
				
						setupPlan();

						shoppingList();
		            });



		}

		function foodPlan() {



			$("#food-plan-content").val(" ");

			$(".hideable").addClass("hide");

			$("#food-plan-content").val("" + planFood[ code.substring(0,1) ][code.substring(1,2)]) ;

			$("#planFoodPanal").removeClass("hide");

			
			ingredientSetup();
		}

		function ingredientUpdate(id) {

			var i = "";
			var a = "";

			if(id === 'newI') {
				i = $('#newI').find( ".icontent" ).val(   );
				a = $('#newI').find( ".iamount" ).val(   );
			} else {
				i = $('#' + id).find( ".icontent" ).val(   );
				a = $('#' + id).find( ".iamount" ).val(   );
			}


			$.post( "https://rocky-earth-6889.herokuapp.com/ingredient_entries.json", {"ingredient_entry":{"user": getUrlParameter('u') ,"code":code, "codea": code.substring(0,1), "codeb":parseInt(code.substring(1,2)), "week":"2017-07-31", "weekname": getUrlParameter('w'), "plan":0, "content": i, "amount":a }} )
		              .done(function( data ) {
		              	
		              	ingredients[ingredients.length] = { code: code, ingredient: i, amount: a};
						
						ingredientSetup();
				
						setupPlan();

						shoppingList();

		            });

		}

		function ingredientSetup() {

			$(".removable").remove();
			shoppingList();

			for (var i = 0; i < ingredients.length; i++) {
				
				if(ingredients[i].code == code ) {
					
					var ingredienttemplate = $("#ingredienttemplate").clone();

				    ingredienttemplate.attr( 'id', code + "-" + i );
				    ingredienttemplate.addClass('removable col-md-12');
				    ingredienttemplate.removeClass('hide');
				    ingredienttemplate.find( ".icontent" ).val( ingredients[i].ingredient  );
				    ingredienttemplate.find( ".iamount" ).val( ingredients[i].amount  );
				    ingredienttemplate.find( ".btn" ).attr( 'onClick', "ingredientUpdate('"+ i +"')");

				   
				    $("#insertingredient").append( ingredienttemplate );
				}
			}

					var ingredienttemplate = $("#ingredienttemplate").clone();

				    ingredienttemplate.attr( 'id', 'newI' );
				    ingredienttemplate.addClass('removable col-md-12');
				    ingredienttemplate.removeClass('hide');
				    ingredienttemplate.find( ".icontent" ).val( ""  );
				    ingredienttemplate.find( ".iamount" ).val( ""  );
				    ingredienttemplate.find( ".btn" ).attr( 'onClick', "ingredientUpdate('newI')");
				   
				    $("#insertingredient").append( ingredienttemplate );


		}

		function foodPlanSave() {

			$.post( "https://rocky-earth-6889.herokuapp.com/calendar_entries.json", {"calendar_entry":{"user": getUrlParameter('u') ,"code":code, "codea": code.substring(0,1), "codeb":parseInt(code.substring(1,2)), "week":"2017-07-31", "weekname": getUrlParameter('w'), "plan":0, "content": $("#food-plan-content").val(), "colour":"food" }} )
		              .done(function( data ) {
		              	
		              	planFood[ code.substring(0,1) ][code.substring(1,2)] = $("#food-plan-content").val();
				
						setupPlan();

						shoppingList();

		            });
				
		}

		function shoppingList() {

			$("#insertshopping").find(".removable").remove();

			for (var i = ingredients.length - 1; i >= 0; i--) {
				if(ingredients[i].ingredient.length > 1 ) {
					

					var ingredienttemplate = $("#shoppingtemplate").clone();

				    ingredienttemplate.attr( 'id', '' );
				    ingredienttemplate.addClass('removable');
				    ingredienttemplate.removeClass('hide');
				    ingredienttemplate.find( ".icontent" ).html( ingredients[i].ingredient  );
				    ingredienttemplate.find( ".iamount" ).html( ingredients[i].amount  );

				   
				    $("#insertshopping").append( ingredienttemplate );

				}
			}
		}

		function readTracker(i) {
			

			window.location.href = "week5-tracker.html?u=" + getUrlParameter('u') + "&t=" + getUrlParameter('t') + "&w=week" +  i ;
		}
    	
		
    	
    </script>


    <script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-71250097-1', 'auto');
	  ga('send', 'pageview');

	</script>
</html>
